<!DOCTYPE html>
<html lang="es">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" 
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="/assets/styles.css">
    <title>Peliculas</title>

</head>

<body data-bs-theme="dark">
    <div class ="contenedor_principal">
        <div class="row g-4" id="peliculas">
            <h1 >Peliculas</h1>
        </div>
    </div>      
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>

        function response_received(response) {
            return response.json()
        }
        
        function parse_peliculas(contenido) {
            
            const pelicula = document.getElementById("peliculas");

            for (let index = 0; index < contenido.length; index++) {

                const item = document.createElement("div");
                item.setAttribute("class", "col-6 col-md-4 col-lg-3 col-xl-2");

                const card = document.createElement("a");
                card.setAttribute("class", "card text-decoration-none");
                card.setAttribute("href", `/peliculas?id=${contenido[index].id}`);

                const imagen = document.createElement("img");
                imagen.setAttribute("class", "img-thumbnail");
                imagen.setAttribute("src", contenido[index].imagen)

                const card_body = document.createElement("div");
                card_body.setAttribute("class", "card-body");
                
                const titulo = document.createElement("h6");
                titulo.setAttribute("class", "card-title");
                titulo.setAttribute("h6", contenido[index].titulo)
                titulo.textContent = contenido[index].titulo;

                const ref = document.createElement("a");
                ref.setAttribute("class", "btn btn-primary");
                ref.setAttribute("href", `/peliculas?id=${contenido[index].id}`);
                ref.textContent = "Info";

                card_body.append(titulo);
                card_body.append(ref);
                card.append(imagen);
                card.append(card_body);
                item.append(card);
                pelicula.append(item);
            }
        }
        
        function request_error(error) {
            console.log("ERROR")
            console.log(error);
        }

        fetch("http://localhost:5000/peliculas")
            .then(response_received)
            .then(parse_peliculas)
            .catch(request_error)
    </script> 
</body>

</html>