<!DOCTYPE html>
<html lang="es">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" 
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="../../assets/styles.css">
    <title>Cast</title> 

</head>

<body data-bs-theme="dark"> 

    <div class ="contenedor_principal" id="boton_agregar">
        <div class="row g-4" id="cast">
            <h1 >Interpretes</h1>
        </div>
    </div> 

    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" 
        crossorigin="anonymous"></script>

    <script>

        const params = new URLSearchParams(window.location.search);
        const id = params.get("id");

        const boton_agregar = document.getElementById("boton_agregar");    
        const agregar = document.createElement("a");
        agregar.setAttribute("class", "btn btn-success");
        agregar.setAttribute("id", "boton-agregar");
        agregar.setAttribute("href", `/peliculas/crear?id=${id}`);
        agregar.textContent = "Agregar";
        boton_agregar.append(agregar);

        function response_received(response) {
            return response.json()
        }
        
        function parse_pelicula(content) {

            const cast = document.getElementById("cast");  
            for (let index = 0; index < content.length; index++) {

                const separador = document.createElement("div");
                separador.setAttribute("class", "separador");

                const div = document.createElement("div");
                div.setAttribute("class", "card mb-4");
                div.setAttribute("style", "max-width: 720px;");

                const div2 = document.createElement("div");
                div2.setAttribute("class", "row g-4");

                const div3 = document.createElement("div");
                div3.setAttribute("class", "col-md-4");
            
                const imagen = document.createElement("img");
                imagen.setAttribute("class", "img-fluid rounded-start");
                imagen.setAttribute("src", content[index].imagen)

                const div4 = document.createElement("div");
                div4.setAttribute("class", "col-md-8");

                const card_body = document.createElement("div");
                card_body.setAttribute("class", "card-body");   
                
                const nombre = document.createElement("label");
                nombre.setAttribute("class", "display-4");
                nombre.textContent = content[index].nombre;

                const interpretacion = document.createElement("h3");
                interpretacion.setAttribute("class", "text-body-secondary");
                interpretacion.textContent = "Personaje: " + content[index].interpretacion;

                const nacionalidad = document.createElement("h3");
                nacionalidad.setAttribute("class", "text-body-secondary");
                nacionalidad.textContent = "Nacionaliad: " + content[index].nacionalidad;

                const nacimiento = document.createElement("h3");
                nacimiento.setAttribute("class", "text-body-secondary");
                nacimiento.textContent = "Fecha de nacimiento: " + content[index].nacimiento;

                const footer = document.createElement("div");
                footer.setAttribute("class", "card-footer"); 

                const eliminar = document.createElement("button");
                eliminar.setAttribute("class", "btn btn-danger");
                eliminar.setAttribute("onclick", "");
                eliminar.textContent = "Eliminar";

                const editar = document.createElement("a");
                editar.setAttribute("class", "btn btn-secondary");
                editar.textContent = "Editar";
                editar.setAttribute("href", ``);
                
                nombre.style.marginBottom = "40px";
                interpretacion.style.marginBottom = "20px";
                nacionalidad.style.marginBottom = "20px";
                nacimiento.style.marginBottom = "20px";

                footer.append(eliminar);                
                div3.append(imagen);
                div2.append(div3);
                card_body.append(nombre);
                card_body.append(interpretacion);
                card_body.append(nacionalidad);
                card_body.append(nacimiento);
                div4.append(card_body);
                card_body.append(editar);
                div3.append(footer);
                div2.append(div4);
                div.append(div2);
                separador.append(div);
                cast.append(separador);
            }
        }
        
        function request_error(error) {
            console.log("ERROR")
            console.log(error);
        }

        fetch("http://localhost:5000/peliculas/reparto/" + id)
            .then(response_received)
            .then(parse_pelicula)
            .catch(request_error)
    </script> 
</body>

</html>